<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stopwatch</title>
<style>
  @font-face {
    font-family: 'ScienceGothic';
    src: url('fonts/ScienceGothic.ttf') format('truetype');
  }

  body {
    background-color: black;
    color: white;
    font-family: 'ScienceGothic', sans-serif;
    margin: 0;
    overflow: hidden;
  }

  .stopwatch {
    position: absolute;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 90px;
    font-weight: 350;
    letter-spacing: 0.15em;
  }

  .info {
    position: absolute;
    top: 55%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 20px;
    color: gray;
  }

  .reset-box {
    position: absolute;
    top: 30px;
    right: 30px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 15px;
    padding: 10px 20px;
    font-size: 18px;
    opacity: 0;
    transition: opacity 0.5s ease;
  }

  .settings-icon {
    position: absolute;
    bottom: 25px;
    right: 25px;
    font-size: 30px;
    cursor: pointer;
    user-select: none;
  }

  .settings-menu {
    position: absolute;
    bottom: 70px;
    right: 25px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 15px;
    padding: 10px 15px;
    display: none;
    flex-direction: column;
    gap: 8px;
  }

  .settings-menu button {
    background: none;
    color: white;
    border: none;
    font-size: 16px;
    cursor: pointer;
  }

  .settings-menu button:hover {
    text-decoration: underline;
  }
</style>
</head>
<body>
  <div class="stopwatch" id="stopwatch">0.0</div>
  <div class="info">press space to start/stop — hold R to reset</div>
  <div class="reset-box" id="resetBox">resetting in 3...</div>
  <div class="settings-icon" id="settingsIcon">⚙️</div>
  <div class="settings-menu" id="settingsMenu">
    <button data-decimals="1">1 decimal</button>
    <button data-decimals="2">2 decimals</button>
    <button data-decimals="3">3 decimals</button>
  </div>

<script>
let startTime = 0;
let elapsedTime = 0;
let timerInterval;
let running = false;
let decimals = 1;
let resetTimer;
let holdTime = 3;
const stopwatch = document.getElementById("stopwatch");
const resetBox = document.getElementById("resetBox");
const settingsIcon = document.getElementById("settingsIcon");
const settingsMenu = document.getElementById("settingsMenu");

function updateDisplay() {
  stopwatch.textContent = (elapsedTime / 1000).toFixed(decimals);
}

document.addEventListener("keydown", (e) => {
  if (e.code === "Space") {
    e.preventDefault();
    if (!running) {
      running = true;
      startTime = Date.now() - elapsedTime;
      timerInterval = setInterval(() => {
        elapsedTime = Date.now() - startTime;
        updateDisplay();
      }, 10);
    } else {
      clearInterval(timerInterval);
      running = false;
    }
  }

  if (e.code === "KeyR") {
    if (!resetTimer) {
      let timeLeft = holdTime;
      resetBox.style.opacity = 1;
      resetBox.textContent = `resetting in ${timeLeft}...`;
      resetTimer = setInterval(() => {
        timeLeft--;
        if (timeLeft > 0) {
          resetBox.textContent = `resetting in ${timeLeft}...`;
        } else {
          clearInterval(resetTimer);
          resetTimer = null;
          elapsedTime = 0;
          updateDisplay();
          resetBox.textContent = "reset!";
          setTimeout(() => {
            resetBox.style.opacity = 0;
          }, 800);
        }
      }, 1000);
    }
  }
});

document.addEventListener("keyup", (e) => {
  if (e.code === "KeyR" && resetTimer) {
    clearInterval(resetTimer);
    resetTimer = null;
    resetBox.style.opacity = 0;
  }
});

settingsIcon.addEventListener("click", () => {
  settingsMenu.style.display = settingsMenu.style.display === "flex" ? "none" : "flex";
});

settingsMenu.querySelectorAll("button").forEach(btn => {
  btn.addEventListener("click", () => {
    decimals = parseInt(btn.dataset.decimals);
    updateDisplay();
    settingsMenu.style.display = "none";
  });
});

updateDisplay();
</script>
</body>
</html>
