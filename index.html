<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Stopwatch</title>

  <style>
    @font-face {
      font-family: "Science Gothic";
      src: url("fonts/ScienceGothic[CTRS,slnt,wdth,wght].ttf") format("truetype-variations");
      font-weight: 100 900;
      font-stretch: 50% 200%;
      font-style: normal;
    }

    html, body {
      height: 100%;
      margin: 0;
      background: #000;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: "Science Gothic", system-ui, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      user-select: none;
      overflow: hidden;
    }

    .wrap {
      text-align: center;
      padding: 10px;
    }

    .time {
      font-size: clamp(48px, 10vw, 140px);
      line-height: 0.9;
      letter-spacing: -0.03em;
      /* now weight 400 */
      font-variation-settings: "wdth" 120, "wght" 400, "slnt" 0, "CTRS" 0;
      font-feature-settings: "tnum" 1;
    }

    .hint {
      margin-top: 8px;
      font-size: 12px;
      font-weight: 600;
      opacity: 0.6;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .running .time {
      text-shadow: 0 4px 15px rgba(0,255,140,0.05), 0 1px 0 rgba(255,255,255,0.03);
    }

    ::selection { background: rgba(255,255,255,0.08); }
  </style>
</head>
<body>
  <div class="wrap" id="wrap">
    <div id="timeDisplay" class="time">0:00.000</div>
    <div class="hint">PRESS SPACE TO START/STOP | R TO RESET</div>
  </div>

  <script>
    (function(){
      const display = document.getElementById('timeDisplay');
      const wrap = document.getElementById('wrap');

      let running = false;
      let startTs = 0;
      let elapsed = 0;
      let rafId = null;

      function formatTime(ms){
        const totalMilliseconds = Math.floor(ms);
        const milliseconds = totalMilliseconds % 1000;
        const totalSeconds = Math.floor(totalMilliseconds / 1000);
        const seconds = totalSeconds % 60;
        const minutes = Math.floor(totalSeconds / 60);
        return `${minutes}:${String(seconds).padStart(2,'0')}.${String(milliseconds).padStart(3,'0')}`;
      }

      function render(){
        const now = performance.now();
        const currentElapsed = elapsed + (running ? Math.floor(now - startTs) : 0);
        display.textContent = formatTime(currentElapsed);
      }

      function tick(){
        render();
        rafId = requestAnimationFrame(tick);
      }

      function start(){
        if (running) return;
        running = true;
        startTs = performance.now();
        wrap.classList.add('running');
        if (!rafId) tick();
      }

      function stop(){
        if (!running) return;
        const now = performance.now();
        elapsed += Math.floor(now - startTs);
        running = false;
        wrap.classList.remove('running');
        render();
      }

      function reset(){
        running = false;
        elapsed = 0;
        wrap.classList.remove('running');
        render();
      }

      function toggle(){
        running ? stop() : start();
      }

      window.addEventListener('keydown', function(e){
        if (e.code === 'Space'){
          e.preventDefault();
          toggle();
        } else if (e.key.toLowerCase() === 'r') {
          e.preventDefault();
          reset();
        }
      }, {passive:false});

      render();
    })();
  </script>
</body>
</html>
